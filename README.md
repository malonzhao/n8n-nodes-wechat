# n8n-nodes-wechat

这是一个 n8n 社区节点，提供与微信公众号/服务号 API 的集成。它允许您在 n8n 工作流中自动化各种微信公众号/服务号操作。

[n8n](https://n8n.io/) 是一个 [公平代码许可](https://docs.n8n.io/reference/license/) 的工作流自动化平台。

## 安装

按照 n8n 社区节点文档中的 [安装指南](https://docs.n8n.io/integrations/community-nodes/installation/) 进行操作。

## 节点

### Wechat OfficialAccount Trigger
Webhook 触发器节点，用于接收来自微信公众号的事件。

### Wechat OfficialAccount
主节点，提供管理微信公众号的各种操作。

## 操作

### 被动回复操作
- **文本回复** - 向用户发送文本回复
- **图片回复** - 向用户发送图片回复
- **语音回复** - 向用户发送语音回复
- **视频回复** - 向用户发送视频回复
- **音乐回复** - 向用户发送音乐回复
- **图文回复** - 向用户发送图文消息回复

### 留言管理
- **开启文章评论** - 为文章启用评论功能
- **关闭评论** - 禁用评论功能
- **删除评论** - 删除特定评论
- **列出评论** - 列出所有评论
- **精选评论** - 将评论标记为精选
- **取消精选评论** - 移除评论的精选状态
- **回复评论** - 回复评论
- **删除评论回复** - 删除评论的回复

### 客服消息操作
- **创建客服账号** - 创建客服账号
- **更新客服账号** - 更新客服账号信息
- **删除客服账号** - 删除客服账号
- **获取客服账号列表** - 获取所有客服账号
- **获取在线客服账号** - 获取在线客服账号
- **绑定客服账号** - 绑定客服账号
- **创建会话** - 创建客服会话
- **关闭会话** - 关闭客服会话
- **获取会话信息** - 获取会话详情
- **获取会话列表** - 列出所有会话
- **获取等待列表** - 获取等待中的客户列表
- **获取消息列表** - 获取消息历史记录
- **发送消息** - 发送客服消息
- **设置会话输入状态** - 设置会话中的输入状态

### 素材管理
- **创建永久素材** - 创建永久素材
- **获取素材信息** - 获取素材详情
- **删除素材** - 删除素材
- **获取高清语音** - 获取高清语音素材
- **批量获取素材** - 批量获取素材
- **获取素材数量** - 获取素材数量统计
- **上传图片** - 上传图片
- **获取媒体文件** - 获取媒体文件
- **上传临时素材** - 上传临时素材

### 草稿管理
- **切换草稿状态** - 切换草稿状态
- **创建草稿** - 创建新草稿
- **获取草稿信息** - 获取草稿详情
- **更新草稿** - 更新草稿内容
- **删除草稿** - 删除草稿
- **批量获取草稿** - 批量获取草稿
- **统计草稿数量** - 统计草稿数量
- **获取商品卡片的DOM结构** - 获取商品卡片的DOM结构

### 菜单管理
- **创建个性化菜单** - 创建个性化菜单
- **删除个性化菜单** - 删除个性化菜单
- **创建自定义菜单** - 创建自定义菜单
- **删除自定义菜单** - 删除自定义菜单
- **获取自定义菜单** - 获取自定义菜单
- **获取自定义菜单信息** - 获取自定义菜单详情
- **尝试匹配菜单** - 尝试匹配菜单

### 发布管理
- **获取发布信息** - 获取发布详情
- **获取已发布文章** - 获取已发布的文章
- **批量获取发布信息** - 批量获取发布详情
- **发布草稿** - 发布草稿内容
- **删除发布内容** - 删除已发布的内容

### 消息模板管理
- **创建模板** - 创建消息模板
- **删除模板** - 删除消息模板
- **获取所有模板** - 获取所有消息模板
- **获取行业信息** - 获取行业分类信息
- **查询屏蔽模板消息** - 查询被屏蔽的模板消息
- **发送模板消息** - 发送模板消息
- **设置行业** - 设置行业类别

### 用户管理
- **获取粉丝列表** - 获取关注者列表
- **获取用户信息** - 获取用户详情
- **批量获取用户信息** - 批量获取用户详情
- **更新用户备注** - 更新用户备注信息
- **获取黑名单** - 获取黑名单列表
- **批量加入黑名单** - 批量将用户加入黑名单
- **批量移出黑名单** - 批量将用户移出黑名单
- **创建标签** - 创建用户标签
- **更新标签** - 更新用户标签
- **删除标签** - 删除用户标签
- **获取所有标签** - 获取所有标签列表
- **批量打标签** - 批量为用户打标签
- **批量移除标签** - 批量移除用户标签
- **获取标签粉丝** - 按标签获取粉丝
- **获取标签ID列表** - 获取标签ID列表

## 凭证

要使用此节点，您需要设置微信公众号凭证：

1. **前提条件**：您需要拥有已启用API访问的微信公众号
2. **认证方法**：使用 AppID 和 AppSecret 的 OAuth 2.0 认证
3. **必填字段**：
	- **AppID (开发者ID)**：您的微信公众号 AppID
	- **AppSecret (开发者密码)**：您的微信公众号 AppSecret

凭证将自动处理令牌管理并在令牌过期时刷新令牌。

## 使用说明

### 设置触发器节点

1. 将 "Wechat OfficialAccount Trigger" 节点添加到您的工作流中
2. 配置 webhook 设置：
	- **令牌**：设置与微信公众号配置中相同的令牌
	- **消息加解密方式**：选择明文模式、兼容模式或安全模式
	- **AES密钥**：兼容模式和安全模式需要（必须与微信公众号配置匹配）

3. 在微信公众号配置中使用生成的 webhook URL

### 使用主节点

1. 将 "Wechat OfficialAccount" 节点添加到您的工作流中
2. 选择您要执行的资源和操作
3. 配置所选操作所需的参数
4. 连接其他 n8n 节点以构建自动化工作流

## 参考

- [n8n 社区节点文档](https://docs.n8n.io/integrations/#community-nodes)
- [微信公众号开发文档](https://developers.weixin.qq.com/doc/service/guide/)
- [微信API文档](https://developers.weixin.qq.com/doc/service/api/)

## 版本历史

### 1.0.0 (当前版本)
- 首次发布，提供全面的微信公众号集成
- 支持所有主要API操作
- Webhook触发器用于接收微信事件
- 自动令牌管理
- 中文界面支持

## 许可证

本项目采用 MIT 许可证。详见 [LICENSE](LICENSE) 文件。

## 支持

如有问题或功能请求，请在 [GitHub 仓库](https://github.com/malonzhao/n8n-nodes-wechat) 中创建 issue。

## 贡献

欢迎贡献！请随时提交 pull request 或为 bug 和功能请求创建 issue。
